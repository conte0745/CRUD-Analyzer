<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.test.ComplexJoinMapper">
    
    <select id="findUsersWithPosts" resultType="UserWithPost">
        SELECT 
            u.id as user_id,
            u.name as user_name,
            u.email,
            p.id as post_id,
            p.title,
            p.content,
            c.name as category_name
        FROM users u
        LEFT JOIN posts p ON u.id = p.author_id
        INNER JOIN categories c ON p.category_id = c.id
        WHERE u.active = 1
          AND p.published = 1
          AND c.visible = 1
        ORDER BY u.name, p.created_at DESC
    </select>
    
</mapper>
